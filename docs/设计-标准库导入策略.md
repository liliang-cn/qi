# Qi 语言标准库导入策略

## 设计哲学：混合方式

Qi 语言标准库采用**混合导入策略**，平衡便利性与模块化：

### 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| 全部内置 | 使用方便 | 命名空间污染 | 小型脚本 |
| 全部导入 | 命名空间清晰 | 基础功能繁琐 | 大型项目 |
| **混合方式** ✅ | 平衡便利与清晰 | 需要明确分类 | 所有场景 |

### 分类标准

#### 1. 内置函数（无需导入）

**核心 I/O 函数**
```qi
打印("Hello")        // 直接可用
打印行("World")      // 直接可用
```

**当前内置的标准库函数**
```qi
// 加密模块（临时内置，未来将改为导入）
MD5哈希("text")
SHA256哈希("text")
SHA512哈希("text")
Base64编码("text")
Base64解码("encoded")
HMAC_SHA256("message", "key")
```

#### 2. 需要导入的模块（未来实现）

**标准库模块**
```qi
导入 标准库.加密;
导入 标准库.文件;
导入 标准库.网络;
导入 标准库.数学;

函数 入口() {
    // 使用模块命名空间
    变量 哈希 = 加密.MD5哈希("text");
    变量 文件 = 文件.打开("路径.txt");
    变量 结果 = 数学.平方根(16.0);
}
```

**第三方包**
```qi
导入 包.json;
导入 包.http.客户端;

函数 入口() {
    变量 数据 = json.解析("{\"key\": \"value\"}");
    变量 响应 = 客户端.GET("https://api.example.com");
}
```

## 当前状态（v0.1.0）

### ✅ 已实现
- 核心 I/O 函数内置（打印、打印行）
- 加密函数临时内置（MD5哈希、SHA256哈希等）

### 🚧 开发中
- 模块化导入系统
- 命名空间支持

### 📅 未来计划
1. **Phase 1: 导入语法**
   ```qi
   导入 标准库.加密;           // 导入整个模块
   导入 标准库.加密.MD5哈希;   // 导入单个函数
   ```

2. **Phase 2: 命名空间**
   ```qi
   加密.MD5哈希("text")        // 模块前缀调用
   ```

3. **Phase 3: 别名支持**
   ```qi
   导入 标准库.加密 作为 crypto;
   crypto.MD5哈希("text")
   ```

4. **Phase 4: 选择性导入**
   ```qi
   导入 标准库.加密 { MD5哈希, SHA256哈希 };
   MD5哈希("text")  // 直接使用
   ```

## 迁移路径

### 当前用法（临时）
```qi
包 主程序;

函数 入口() {
    变量 哈希 = MD5哈希("text");  // 内置函数
    打印行(哈希);
}
```

### 未来用法（目标）
```qi
包 主程序;

导入 标准库.加密;

函数 入口() {
    变量 哈希 = 加密.MD5哈希("text");  // 模块函数
    打印行(哈希);                       // 内置函数
}
```

### 兼容性保证
1. 核心 I/O 函数（打印、打印行）永久内置
2. 其他内置函数在引入导入系统后保留1-2个版本
3. 提供自动迁移工具

## 标准库模块规划

### 核心模块
```
标准库/
├── 加密/          # 加密与哈希
│   ├── MD5哈希
│   ├── SHA256哈希
│   ├── Base64编码
│   └── ...
├── 文件/          # 文件操作
│   ├── 读取
│   ├── 写入
│   └── 删除
├── 网络/          # 网络通信
│   ├── HTTP/
│   │   ├── 客户端
│   │   └── 服务器
│   └── TCP/
│       ├── 监听
│       └── 连接
├── 数学/          # 数学运算
│   ├── 三角函数
│   ├── 统计
│   └── 随机数
├── 时间/          # 时间处理
│   ├── 当前时间
│   ├── 格式化
│   └── 解析
└── 字符串/        # 字符串处理
    ├── 分割
    ├── 连接
    └── 替换
```

## 实现优先级

### P0（必须实现）
- [ ] 导入语法解析
- [ ] 模块注册系统
- [ ] 命名空间解析

### P1（应该实现）
- [ ] 标准库模块化重构
- [ ] 选择性导入
- [ ] 导入缓存

### P2（可以实现）
- [ ] 别名支持
- [ ] 相对导入
- [ ] 循环依赖检测

## 参考资料

- Rust: `use std::collections::HashMap;`
- Python: `from hashlib import md5`
- Go: `import "crypto/md5"`
- JavaScript: `import { md5 } from 'crypto';`

## 设计原则

1. **渐进式采用**：从简单到复杂
2. **中文优先**：所有 API 使用中文
3. **向后兼容**：保护现有代码
4. **性能优先**：编译时解析，零运行时开销
5. **清晰明确**：避免隐式行为

---

**版本**：v0.1.0
**状态**：草案
**更新时间**：2025-01-02
