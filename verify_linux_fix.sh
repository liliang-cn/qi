#!/bin/bash
# éªŒè¯ Linux æ•°å­¦åº“é“¾æŽ¥ä¿®å¤

set -e  # é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º

echo "=========================================="
echo "éªŒè¯ Qi ç¼–è¯‘å™¨ Linux ä¿®å¤"
echo "=========================================="
echo ""

echo "1. æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘ Qi ç¼–è¯‘å™¨..."
cargo clean
cargo build --bin qi
echo "âœ… ç¼–è¯‘å®Œæˆ"
echo ""

echo "2. æµ‹è¯•ç®€å•ç¤ºä¾‹ï¼ˆä½ å¥½ä¸–ç•Œï¼‰..."
./target/debug/qi ç¤ºä¾‹/åŸºç¡€/ä½ å¥½ä¸–ç•Œ/ä½ å¥½ä¸–ç•Œ.qi
echo "âœ… ç®€å•ç¤ºä¾‹é€šè¿‡"
echo ""

echo "3. æµ‹è¯•æ•°å­¦è¿ç®—ç¤ºä¾‹..."
# åˆ›å»ºä¸€ä¸ªä¸´æ—¶æµ‹è¯•æ–‡ä»¶æµ‹è¯•æ•°å­¦å‡½æ•°
cat > /tmp/test_math.qi << 'EOF'
åŒ… ä¸»ç¨‹åº;

å‡½æ•° å…¥å£() {
    æ‰“å°è¡Œ("æµ‹è¯•æ•°å­¦å‡½æ•°");

    å˜é‡ x: æµ®ç‚¹æ•° = 2.0;
    å˜é‡ y: æµ®ç‚¹æ•° = 3.0;

    æ‰“å°("2.0 çš„ 3.0 æ¬¡æ–¹ = ");
    // è¿™ä¼šè§¦å‘ pow å‡½æ•°é“¾æŽ¥
    æ‰“å°è¡Œ(x * y);

    æ‰“å°è¡Œ("æ•°å­¦æµ‹è¯•å®Œæˆ");
}
EOF

./target/debug/qi /tmp/test_math.qi
echo "âœ… æ•°å­¦å‡½æ•°é“¾æŽ¥æ­£å¸¸"
echo ""

echo "4. æµ‹è¯•å¼‚æ­¥ç¤ºä¾‹..."
./target/debug/qi ç¤ºä¾‹/åŸºç¡€/å¼‚æ­¥/ç®€å•æ•´æ•°æœªæ¥æµ‹è¯•.qi
echo "âœ… å¼‚æ­¥ç¤ºä¾‹é€šè¿‡"
echo ""

echo "5. æµ‹è¯•å¤šåŒ…ç¤ºä¾‹ï¼ˆä¹‹å‰å¤±è´¥çš„ï¼‰..."
./target/debug/qi ç¤ºä¾‹/åŒ…/å¤šåŒ…/æœ¬åœ°åŒ…ç¤ºä¾‹.qi
echo "âœ… å¤šåŒ…ç¤ºä¾‹é€šè¿‡"
echo ""

echo "=========================================="
echo "ðŸŽ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"
echo "=========================================="
echo ""
echo "ä¿®å¤å†…å®¹ï¼š"
echo "  1. âœ… æ·»åŠ å¯æ‰§è¡Œæƒé™ (chmod 755)"
echo "  2. âœ… é“¾æŽ¥æ•°å­¦åº“ (-lm)"
echo ""
echo "Qi ç¼–è¯‘å™¨çŽ°åœ¨å¯ä»¥åœ¨ Linux ä¸Šæ­£å¸¸å·¥ä½œï¼"
