# Qi语言macOS演示程序 | Qi Language macOS Demo

## 🚀 快速开始 | Quick Start

这个演示程序展示了Qi语言在macOS平台上的各种功能特性。

### 📋 系统要求 | System Requirements

- macOS 10.15+ (Catalina或更高版本)
- Rust 1.75+ (用于编译Qi编译器)
- LLVM 15.0+ (用于代码生成)
- Xcode Command Line Tools

### 🔧 安装Qi编译器 | Install Qi Compiler

```bash
# 克隆项目
git clone https://github.com/your-org/qi-language.git
cd qi-language

# 切换到正确的分支
git checkout 001-qi-language-compiler

# 编译Qi编译器
cargo build --release

# 将Qi编译器添加到PATH
echo 'export PATH=$PWD/target/release:$PATH' >> ~/.zshrc
source ~/.zshrc
```

### 📝 编译和运行演示程序 | Compile and Run Demo

#### 方法1: 使用命令行编译 | Command Line Compilation

```bash
# 编译为macOS可执行文件
qi compile --target macos examples/mac_demo.qi --output mac_demo

# 运行编译后的程序
./mac_demo
```

#### 方法2: 指定优化级别 | Specify Optimization Level

```bash
# 使用标准优化编译
qi compile --target macos -O standard examples/mac_demo.qi --output mac_demo_optimized

# 运行优化版本
./mac_demo_optimized
```

#### 方法3: 详细输出模式 | Verbose Mode

```bash
# 使用详细模式编译，查看编译过程
qi compile --target macos --verbose examples/mac_demo.qi
```

## 🎯 演示程序功能展示 | Demo Program Features

### 1. 基础功能演示 | Basic Features Demo
- ✅ 中文关键字和变量声明
- ✅ 基础数据类型 (整数、浮点数、布尔、字符串)
- ✅ 数学运算 (斐波那契、阶乘)
- ✅ 数组操作 (求和、最大值)
- ✅ 控制流结构 (当循环、如果判断)

### 2. macOS特定功能 | macOS-Specific Features
- ✅ 进程ID获取
- ✅ 系统时间戳
- ✅ Mach绝对时间 (macOS特有)
- ✅ CoreFoundation字符串操作
- ✅ 文件系统操作模拟
- ✅ 权限检查功能

### 3. 性能测试 | Performance Tests
- ✅ 计算密集型操作测试
- ✅ 内存分配性能测试
- ✅ 函数调用性能测试
- ✅ 执行时间测量

## 📊 预期输出 | Expected Output

```
=== Qi语言macOS演示程序 ===
Welcome to Qi Language macOS Demo

🔧 基础功能演示:
  消息: 你好，macOS世界！
  年份: 2024
  圆周率: 3.14159
  运行状态: 运行中
  斐波那契(10) = 55
  阶乘(6) = 720
  数组 [1-10] 求和: 55
  数组最大值: 10

🍎 macOS特定功能演示:
  进程ID: 12345
  当前时间戳: 1703123456
  Mach绝对时间: 876543210987
    CF字符串: "Hello from Qi on macOS!"
  CoreFoundation字符串创建成功
  模拟写入文件: /tmp/qi_demo.txt
  文件内容: 这是Qi语言在macOS上生成的文件
This file was generated by Qi on macOS
  模拟创建目录: /tmp/qi_demo_dir
  文件权限检查: 可访问

⚡ 性能测试:
  计算 100000 次平方和耗时: Xms
  结果: 333328333350000
  创建和处理 1000 个数组耗时: Xms
  计算 20 个斐波那契数列耗时: Xms

=== 程序执行完成 ===
```

## 🔍 调试和故障排除 | Debugging and Troubleshooting

### 常见问题 | Common Issues

#### 1. 编译错误 | Compilation Errors
```bash
# 检查语法错误
qi check examples/mac_demo.qi

# 查看详细错误信息
qi compile --target macos --verbose examples/mac_demo.qi
```

#### 2. 运行时错误 | Runtime Errors
```bash
# 使用调试模式编译
qi compile --target macos --debug-symbols examples/mac_demo.qi

# 运行时检查错误会显示详细的中文错误消息
```

#### 3. 性能问题 | Performance Issues
```bash
# 使用最高优化级别
qi compile --target macos -O maximum examples/mac_demo.qi

# 检查编译时间
time qi compile --target macos examples/mac_demo.qi
```

### 日志和分析 | Logging and Analysis

#### 查看编译统计信息 | View Compilation Statistics
```bash
# 显示详细的编译统计
qi compile --target macos --verbose --stats examples/mac_demo.qi
```

#### 性能分析 | Performance Profiling
```bash
# 生成性能报告
qi compile --target macos --profile examples/mac_demo.qi
```

## 🎨 自定义和扩展 | Customization and Extension

### 添加新功能 | Add New Features

1. **修改程序代码** | Modify Program Code
   ```qi
   // 添加新的macOS特定功能
   函数 显示系统信息() {
       变量 hostname = 获取主机名();
       打印 "主机名: " + hostname;

       变量 os_version = 获取macOS版本();
       打印 "macOS版本: " + os_version;
   }
   ```

2. **添加到主函数** | Add to Main Function
   ```qi
   函数 主函数() {
       // ... 现有代码 ...

       // 添加新功能调用
       显示系统信息();
   }
   ```

### 扩展macOS运行时 | Extend macOS Runtime

在 `src/targets/macos.rs` 中添加新的运行时函数：

```rust
// 添加新的macOS系统调用
extern fn qi_gethostname() -> String {
    // 调用macOS系统API获取主机名
}

extern fn qi_get_macos_version() -> String {
    // 调用macOS系统API获取版本信息
}
```

## 📚 更多资源 | Additional Resources

- [Qi语言参考文档](docs/language_reference.md)
- [macOS平台特定文档](docs/platforms/macos.md)
- [性能优化指南](docs/performance.md)
- [API参考文档](docs/api_reference.md)

## 🤝 贡献 | Contributing

欢迎提交Issue和Pull Request来改进这个演示程序！

### 开发环境设置 | Development Setup
```bash
# 运行测试
cargo test

# 检查代码风格
cargo fmt --check
cargo clippy

# 运行性能基准测试
cargo bench
```

---

**享受Qi语言在macOS上的编程体验！**
**Enjoy programming with Qi Language on macOS!** 🍎✨